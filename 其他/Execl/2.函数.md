# 1.函数错误信息及原因

```
####					//内容太长或单元格宽度不够
#DIV/0!					//当数字除以零(0)时
#N/A					//数值对函数或公式不可用
#NAME?					//Excel无法识别公式中的文本
#NULL!					//当指定两个不相交的区域的交集时
#NUM!					//公式或函数中使用了无效的数值
#REF!					//引用的单元格无效
#VALUE!					//使用的参数或操作数的类型不正确
```

2.函数分类（功能）

```
加载宏和自动化函数:用于加载宏或执行某些自动化操作

多维数据集函数:用于从多维数据库中提取数据并将其显示在单元格中

数据库函数:用于对数据库中的数据进行分析

日期和时间函数:用于处理公式中与日期和时间有关的值

工程函数:用于处理复杂的数值并在不同的数制和测量体系中进行转换

财务函数:用于进行财务方面的相关

信息函数:可帮助用户函数判断单元格内数据所属的类型以及单元格是否为空等

逻辑函数:用于检测是否满足一个或多个条件

查找和引用函数:用于查找存储在工作表中的特定值

数学和三角函数:用于进行数据和三角方面的各种计算

统计函数:用于对特定范围内的数据进行分析统计

文本函数:用于处理公式中的文本字符串
```

3.引用单元格

**作用：在于标识工作表上的单元格或单元格区域**

```
A1							//列 A和行 1交叉处的单元格
A1:A10						//在列 A和行 1到行 10 之间的单元格
B2:E2						//在行 2和列 B到列E之间的单元格
3:3							//行3中全部的单元格
3:5							//行3到行5 之间全部的单元格
D:D							//列 D 中全部的单元格
A:D							//列 A到列 D 之间全部的单元格
A1:D10						//列 A 到列 D 和行1到行 10 之间的单元格
```

```
相对引用			三维引用
外部引用			绝对引用
											4种
```

4.数组公式

```
ctrl+shift+enter


区域求和：
	sum(c4:c29*d4:d29)
	
	
1.保证区域内所有的公式完全相同。
2.若要向区域的底部添加新数据，则必须对数组公式进行修改以容纳新数据。
3.不能对数组区域中的某个单元格单独进行编辑，减少意外修改公式的可能。若要对数组区域进行编辑则必须将整个区域视为一个单元格进行编辑，否则 Excel会弹出显示错误信息的对话框。
```

# 5.函数

## 1).提取时间和日期函数

### year函数

```
作用：返回对应于某个日期的年份，即一个1900~9999 之间的整数



格式：YEAR(serial_number)
	serial_number：必需。表示要查找年份的日期值。日期有多种输入方式:带引号的文本串、系列数或其他公式或函数的结果
```

### month函数

```
作用：返回对应于某个日期的月份，即一个介于1到12之间的整数,


格式：MONTH(serial_number)
		serial_number：必需。表示要查找月份的日期值。日期有多种输入方式:带引号的文本串、系列数或其他公式或函数的结果
```

### day函数

```
作用：返回对应于某个日期的天数，即一个介于1到31之间的整数

格式：DAY(serial_number)
	serial_number：必需。表示要查找天数的日期值。日期有多种输入方式:带引号的文本串、系列数或其他公式或函数的结果
```

## 2).计算日期和时间

### datedif函数

```
作用：可以计算两个日期期间内的年数、月数和天数

格式：DATEDIF(start date, end date, unit)
start date：必需。表示起始日期。可以是指定日期的数值(序列号值)或单元格引用。" start date"的月份被视为“0” 进行计算
end date：必需。表示终止日期
unit：必需。表示要返回的信息类型


unit参数：
y:计算满年数，返回值为 0以上的整数
m:计算满月数，返回值为 0以上的整数
d:计算满日数，返回值为 0以上的整数
ym:计算不满一年的月数，返回值为 1~11 之间的整数
yd:计算不满一年的天数，返回值为 0~365 之间的整数
md计算不满意一个月的天数，返回值为 0~30 之间的整数
```

### networkdays函数

```
计算两个日期之间的天数


有3种日期和时间函数
NETWORKDAYS
DATEVALUE
days


函数-格式-计算结果
NETWORKDAY
	数值(序列号)、日期、文本形式
	计算除了周六、日和休息日之外的工作天数，计算结果比另两个函数小
DATEVALUE
	文本形式
	从表示日期的文本中计算出表示日期的数值，计算结果大于 NETWORKDAYS 函数、等于 DAYS 函数
DAYS
    数值(序列号)、日期、文本形式
    计算两日期间相差的天数，计算结果大于NETWORKDAYS 函数、等于 DATEVALUE 函数
```

#### NETWORKDAYS

```
作用：函数可以计算除了周六、日和休息日之外的工作天数

格式：NETWORKDAYS(start date, end date, holidays)
start date
	必需。表示起始日期。可以是指定日期的数值(序列号值)或单元格引用。“ start date”的月份被视为“0”进行计算
end date
	必需。表示终止日期。可以是指定序列号值或单元格引用
holidays
	可选。表示节日或假日等休息日。可以是指定序列号值、单元格引用和数组常量。当省略了此参数时，返回除了周六、日之外的指定期间内的天数
```

## 3).数学函数

### product函数

```
作用：求乘积



格式：PRODUCT(number1, number2, ...)
number1：
	必需。表示要相乘的第一个数字或区域。可以是数字、单元格引用和单元格区域引用。
number2
	可选。表示要相乘的第 2~255 个数字或区域，即可以像number1 那样最多指定 255 个参数
```

### sum函数

```
作用：求和


格式：SUM(number1, number2, ...)
number1：
	必需。表示要相加的第一个数字或区域。可以是数字、单元格引用和单元格区域引用。
number2
	可选。表示要相加的第 2~255 个数字或区域，即可以像number1 那样最多指定 255 个参数
```

### sumif函数

```
作用：条件求和


格式:SUMIF(range,criteria, [sum_range])
range
	必需。表示根据条件进行计算的单元格区域，即设置条件的单元格区域。区域内的单元格必须是数字、名称、数组或包含数字的引用，空值和文本值将会被忽略
criteria
	必需。表示求和的条件。其形式可以是数字、表达式、单元格引用、文本或函数指定的条件(引用单元格和数字除外)必须用双引号括起来
sun range
	可选。表示实际求和的单元格区域。如果省略此参数，那么Excel会将range 参数中指定的单元格区域设为实际求和区域
```

#### 通配符

```
*：匹配任意一串字节
？：匹配任意单个字符
~指定不将*和?视为通配符看待
```

### quotient函数

```
作用：计算并返回除法的整数部分


格式：QUOTENT(numerator, denominator)
numerator
	必需。表示被除数。可以是数字、单元格引用或单元格区域引用
denominator
	必需。表示除数。可以是数字、单元格引用或单元格区域引用
```

### round函数

```
作用：将数字四舍五入到指定的位数


格式：ROUND(number, num_digits)
number
	必需。表示要四舍五入的数字
num_digits
	必需。表示要进行四舍五入运算的位数
```

## 4.统计函数

### count函数

```
作用：计数


格式：COUNT(valuel, value2, ...)
value1
	必需。表示要计算其中数字的个数的第1项。可以是数组、单元格引用或区域。只有数字类型的数据才会被计算，如数字、日期或代表数字的文本(如“1”)
value2,
	可选。表示要计算其中数字的个数的第 2~255 项，即可以像参数value1 那样最多指定 255 个参数
```

### countif函数

```
作用：条件计数

格式：COUNTIF(range, criteria)
range
	必需。表示要查找的单元格区域
criteria
	必需。表示查找的条件。可以是数字、表达值或文本
```

## 5.平均值

### average函数

```
作用：计算参数的平均值(算术平均值)


格式：AVERAGE(number1,number2, ...)
number1
	必需。要计算平均值的第一个数字、单元格引用或单元格区域
number2,.
	可选。要计算平均值的第2~255个数字、单元格引用或单元格区域，最多可包含255个
```

### averageif函数

```
作用：计算某个区域内满足给定条件的所有单元格的平均值(算术平均值)


格式：AVERAGEIF(range, criteria, average_range)
range
	必需。表示要计算平均值的一个或多个单元格(即要判断条件的区域)，其中包含数字或包含数字的名称、数组或引用
criteria
	必需。表示给定的条件。可以是数字、表达式、单元格引用或文本形式的条件
average rang6
	可选。表示要计算平均值的实际单元格区域。若省略此参数，则使用range参数指定的单元格区域
```

## 6).最大值和最小值

### **max/min**

```
max:最大值
min:最小值

格式：MAX(number1, number2, ..)
格式：
numberl
	必需。表示要查找最大值的第1个数字参数，可以是数字、数组或单元格引用
number2,
	可选。表示要查找最大值的第 2~255 个数字参数，即可以像参数number1那样最多指定 255 个参数
	
格式：MIN(number1, number2, ..)
格式：
numberl
	必需。表示要查找最小值的第1个数字参数，可以是数字、数组或单元格引用
number2,
	可选。表示要查找最小值的第 2~255 个数字参数，即可以像参数number1那样最多指定 255 个参数
```

### large函数

```
作用：可以返回数据集中第k个最大值

格式：LARGE(array, k)
array
	必需。表示需要查找的第k个最大值的数组或数据区域
k
	必需。表示返回值在数组或数据单元格区域中的位置(从大到小排)
```

### SMALL函数

```
作用：可以返回数据集中的第k个最小值


格式： SMALL(array, k)
array
	必需。表示需要查找的第k个最小值的数组或数据区域
k
	必需。表示返回值在数组或数据单元格区域中的位置(从小到大排)
```

## 7).计算众数和频率

### mode.sngl函数

```
作用：可以返回在某一数组或数据区域中的众数

格式：MODE.SNGL(number1, number2,...)
number1
	必需。表示要计算其众数的第1个参数。可以是数字、包含数字的名称、数组和单元格引用
number2,
	可选。表示要计算其众数的第2~255个参数，即可以像参数number1那样最多指定255个参数
```

### frequency函数

```
作用：FREQUENCY 函数可以计算数值在某个区域内的出现频率，然后返回一个垂直数组。由于FREQUENCY 返回-个数组，所以它必须以数组公式的形式输入。

格式：frequency(data_array,bins_array)
data array
	必需。表示要对其频率进行计数的一组数值或对这组数值的引用。若参数data_array 中不包含任何数值，则爾数 FREQUENCY 返回一个零数组。
bins array
	必需。表示要将参数 data array 中的值插入到的间隔数组或对间隔的引用若参数 bins array中不包含任何数值，则数 FREQUENCY 返回data array 中的元素个数。
```

## 8).文本函数

### exact函数

```
作用：比较两个字符串是否完全相同

格式：EXACT(text1,text2)
text1
    必需。表示第一个文本字符串
text2
    必需。表示第二个文本字符串

```

### concatenate函数

```
作用：可以将几个文本字符串合并为一个文本字符串

格式：CONCATENATE(text1l, text2, ...)
text1
    必需。表示第一个将要合并成单个文本的文本项
text2,
    可选。表示第 2~255 个将要合并成单个文本的文本项

```

### len函数

```
作用：返回字符串的长度

格式：LEN(text)
text
	必需。表示要查找其长度的文本。空格将作为字符进行计数	
```

### find函数

```
作用：可以查找一个字符串在另外一个字符串中的位置(字母区分大小写）

格式：FIND(find text, within_text, start_num)
find text
	必需。表示要查找的文本
within tex
	必需。表示包含要查找文本的文本
start num
	可选。表示开始进行查找的字符。Within text中的首字符是编号为1的字符。如果省略start num，那么假定其值为 1
```

### search函数

```
作用：S在其他文本字符串中查找指定的文本字符串，并返回该字符串的起始位置编号(字母不区分大小写)。

格式：SEARCH(find text, within text, start num)
find text
	必需。表示要查找的文本(不区分大小写)
within tex
	必需。表示要在其中搜索 find text 参数的值的文本
start num
	可选。表示 within text 参数中从之开始搜多的字符编号
```

### left函数

```
作用：基于指定的字符数返回文本字符串中的第一个或前几个字符

格式：LEFT(text, num_chars)
text
    必需。表示包含要提取的字符的文本字符串
num chars
    可选。表示要由 LEFT 提取的字符的数量。若省略，则假定其值为1
```

### right函数

```
作用：根据所制定的字符数返回文本字符串中最后一个或多个字符

格式：RIGHT(text, num_chars)
text
	必需。表示包含要提取字符的文本字符串
num char
	可选。表示希望 RIGHT提取的字符数
```

### substitute函数

```
作用：在无文本字符串中，用新的文本替代旧的文本

格式:SUBSTITUTE(text, old text, new_text, instance_num)
text
	必需。表示需要替换其中字符的文本，或对含有需要替换其中字符的文本单元格的引用
old text
	必需。表示需要替换的文本
new text
	必需。表示用于替换旧文本的文本
instance num
	可选。表示指定要用new text替换old text的事件
```

### replace和replaceb函数

```
作用：REPLACE 西数与 REPLACEB 函数的功能是使用其他的文本字符串并根据所指定的字符数替换某文本字符串中的部分文本。

格式：
    REPLACE(old text,start num,num chars, new text)
    REPLACEB(old text,start num,num bytes, new_text)
old text
	必需。表示要替换其部分字符的文本
start num
	必需。表示 old text 中要替换为 new text的字符位置
num char
	必需。表示 ole text 中希望 REPLACE 使用 new text 来进行替换的字符数
num byte
	必需。表示 ole text 中希望 REPLACE 使用new text 来进行替换的字节数
new text
	必需。表示将替换 old text 中字符的文本
```

### if函数

```
作用：是执行真假值判断，根据逻辑值计算的真假值返回不同的结果

格式：IF(logical_test, value_if_true, value_if_false)
logical test
	必需。表示要测试的条件
value if true
	必需。表示要测试的条件
value if false
	必需。表示logical test 的结果为TRUE 时，希望返回的值可选。表示logical test 的结果为 FALSE 时，希望返回的值
```

### and函数

```
作用：是多个逻辑值进行交集计算，用于确定测试中所有条件是否均为 TRUE


格式：AND(logical1, logical2, ...)
logical1
	必需。表示第一个需要测试且计算结果可为 TRUE 或 FALSE 的条件
logical2
	可选。表示其他需要测试且计算结果可为TRUE或 FALSE的条件(最多255 个条件)
```

### or函数

```
作用：多个逻辑值进行并集计算，用于确定测试集中的所有条件是否均为 TRUE

格式：OR(logical1, logical2, ...)
logical1
	必需。表示第一个需要测试且计算结果可为TRUE 或 FALSE 的条件
logical2
	可选。表示其他需要测试且计算结果可为TRUE或FALSE的条件(最多255 个条件)
```

